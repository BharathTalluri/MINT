%%% DIRECT_METHOD Estimate entropy quantities with direct method.
%%%
%%% This function is the direct method engine of called by ENTROPY and its
%%% related functions.
%%%
%%% USAGE
%%%
%%%   [HX, HXY, HlX, HlXY, HiX, HiXY, ChiX, HshX, HshXY] = direct_method(X, nt, pars);
%%%
%%%
%%% INPUTS
%%%
%%%   X    - response matrix
%%%   pars - parameters structure
%%%
%%% *function direct_method*
%%%
%%% ### Description
%%% Estimate entropy quantities with direct method. This function is the direct method engine of called by ENTROPY and its related functions.
%%%
%%% ### Inputs:
%%% - *X*: *nDimensions x nTrials x nStimuli* array including response data.
%%% - *pars*: parameter structure to check generated by build_parameters_structure.
%%%
%%% ### Outputs:
%%% - *HX*: direct estimate of H(X).
%%% - *HXY*: direct estimate of H(X|Y).
%%% - *HlX*: direct estimate of H_lin(X).
%%% - *HlXY*: direct estimate of H_lin(X|Y).
%%% - *HiX*: direct estimate of H_ind(X).
%%% - *HiXY*: direct estimate of H_ind(X|Y).
%%% - *ChiX*: direct estimate of Chi(X).
%%% - *HshX*: direct estimate of H_shuffle(X).
%%% - *HshXY*: direct estimate of H_shuffle(X|Y).
%%%
%%% ### Further notes:
%%%
%%% The parameters structure must include the following fields:
%%%
%%% =========================================================================
%%% | FIELD NAME       | TYPE          | DESCRIPTION                        |
%%% =========================================================================
%%% | pars.nt          | numeric array | number of trials per stimulus.     |
%%% |-----------------------------------------------------------------------|
%%% | pars.biasCorrNum | scalar value  | bias correction number:            |
%%% |                  |               |                                    |
%%% |                  |               |  -1 : user-defined bias            |
%%% |                  |               |       correction routine           |
%%% |                  |               |                                    |
%%% |                  |               |   2 : Panzeri & Treves             |
%%% |-----------------------------------------------------------------------|
%%% | pars.doHX        | logical value | flag specifying whether H(X) needs |
%%% |                  |               | to be estimated                    |
%%% |-----------------------------------------------------------------------|
%%% | pars.doHXY       | logical value | flag specifying whether H(X|Y)     |
%%% |                  |               | needs to be estimated              |
%%% |-----------------------------------------------------------------------|
%%% | pars.doHlX       | logical value | flag specifying whether H_lin(X)   |
%%% |                  |               | needs to be estimated              |
%%% |-----------------------------------------------------------------------|
%%% | pars.doHlXY      | logical value | flag specifying whether H_lin(X|Y) |
%%% |                  |               | needs to be estimated              |
%%% |-----------------------------------------------------------------------|
%%% | pars.doHiX       | logical value | flag specifying whether H_ind(X)   |
%%% |                  |               | needs to be estimated              |
%%% |-----------------------------------------------------------------------|
%%% | pars.doHiXY      | logical value | flag specifying whether H_ind(X|Y) |
%%% |                  |               | needs to be estimated              |
%%% |-----------------------------------------------------------------------|
%%% | pars.doChiX      | logical value | flag specifying whether Chi(X)     |
%%% |                  |               | needs to be estimated              |
%%% |-----------------------------------------------------------------------|
%%% | pars.doHshX      | logical value | flag specifying whether H_sh(X)    |
%%% |                  |               | needs to be estimated              |
%%% |-----------------------------------------------------------------------|
%%% | pars.doHshXY     | logical value | flag specifying whether H_sh(X|Y)  |
%%% |                  |               | needs to be estimated              |
%%% |-----------------------------------------------------------------------|
%%% | pars.testMode    | logical value | flag specifying whther test-mode   | 
%%% |                  |               | has been selected                  |
%%% =========================================================================
%%%
%%% Zero is returned for all outputs corresponding to output options that were not selected by the user.
%%%
