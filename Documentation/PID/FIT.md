%%% *function [FIT, varargout] = FIT(S, hX, hY, Y, varargin)*
%%%
%%% ### Description
%%% This function computes the Feature-specific (i.e. $S$-specific) Information Transmission (FIT) between a *source* $X$ and a *receiver* $Y$. NIT provides tools for both naive or bias-corrected estimation, given input data.
%%%
%%% ### Inputs:
%%% - *S*: must be an array of *nDimsS X nTrials * elements representing the discrete value of the stimulus presented in each trial.
%%% - *hX*: must be an array of *nDimsX X nTrials* response matrix describing the past of the emitter variables on each of the *nDims* dimensions for each trial.
%%% - *hY*: must be an array of *nDimsY X nTrials* response matrix describing the past of the receiver variable on each of the *nDims* dimensions for each trial.
%%% - *Y*: must be an array of *nDimsY X nTrials* response matrix describing the response of each of the *nDims* dimensions for each trial.
%%% - *opts*: options used to calculate FIT (see further notes).
%%%
%%% ### Outputs:
%%% - *FIT*: data structure containing naive, and bias corrected (if required) estimation of the $S$-related Information Transfer between the *source* $X$ and the *receiver* $Y$. If calculated, the structure contains as well the btsp estimate. In case of multiple bootstrapping options (i.e. in case of `length(opts.btsp_variables) > 1`) multiple bootstrap estimates are returned. 
%%% ### Further notes:
%%% The *opts* structure can have the following fields:
%%%
%%% | field                                | description                                                                                                                                                                                                                                             | allowed values                                                                                                                                                                                                                                     | default   |
%%% |--------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|-----------|
%%% | opts.bias                            | specifies the bias correction method                                                                                                                                                                                                                    | `'naive'` (no bias correction)<br>`'le'` (linear extrapolation)<br>`'qe'` (quadratic extrapolation)                                                                                                                                                | `'naive'` |
%%% | opts.max_draws_per_split_number      | specifies the maximum number of draws on which to calculate the unbiased estimate of II. E.g. `opts.max_draws_per_split_number = 10`, the II is calculated as average on 20 trials for 2 splits and 10 trials for 1 split. (ignored if opts.bias = 'naive') | int > 0                                                                                                                                                                                                                                        | 50        |
%%% | opts.bin_methodX                     | specifies the binning method for the X signals                                                                                                                                                                                                          | `'none'` (no binning)<br>`'eqpop'` (evenly populated binning)<br>`'eqspace'`(evenly spaced binning)<br>`'ceqspace'`(centered evenly spaced binning)<br>`'gseqspace'`(gaussian evenly spaced binning)<br> See the documentation of [[binr|binr]] function for more details   | `'eqpop'` |
%%% | opts.bin_methodY                     | specifies the binning method for the Y signals                                                                                                                                                                                                          | `'none'` (no binning)<br>`'eqpop'` (evenly populated binning)<br>`'eqspace'`(evenly spaced binning)<br>`'ceqspace'`(centered evenly spaced binning)<br>`'gseqspace'`(gaussian evenly spaced binning)<br> See the documentation of [[binr|binr]] function for more details   | `'eqpop'` |
%%% | opts.bin_methodS                     | specifies the binning method for the stimulus signals                                                                                                                                                                                                   | `'none'` (no binning)<br>`'eqpop'` (evenly populated binning)<br>`'eqspace'`(evenly spaced binning)<br>`'ceqspace'`(centered evenly spaced binning)<br>`'gseqspace'`(gaussian evenly spaced binning)<br> See the documentation of [[binr|binr]] function for more details   | `'eqpop'` |
%%% | opts.n_binsX                         | number of bins to be used to reduce the dimensionality of the response X                                                                                                                                                                                | int > 1                                                                                                                                                                                                                                            | 3         |
%%% | opts.n_binsY                         | number of bins to be used to reduce the dimensionality of the response Y                                                                                                                                                                                | int > 1                                                                                                                                                                                                                                            | 3         |
%%% | opts.n_binsS                         | number of bins to be used to reduce the dimensionality of the stimulus S                                                                                                                                                                                | int > 1                                                                                                                                                                                                                                            | 2         |
%%% | opts.btsp                            | number of bootstrap operations to perform for significance testing (those will be performed independently on each of the variables listed in `opts.btsp_variables`)                                                                                                              | int >= 0                                                                                                                                                                                                                                                                   | 0         |
%%% | opts.btsp_variables                  | list of variables to be bootstrapped, specified as a cell array of strings. If multiple bootstrapping operations are requested, `opts.btsp_variables` can contain multiple variables. In this case a `opts.btsp_type` option should be specified for each `opts.btsp_variables`  | cell array containing one (or more) strings (`"S"`, `"R"` or `"C"`) corresponding to all variables to be bootstrapped                                                                                                                                                      | N/A       |
%%% | opts.btsp_type                       | type of bootstrapping to be applied for each variable (`'all'` shuffles all values of the corresponding variable in `opts.btsp_variables` across trials, while `'$VAR$conditioned'` shuffles trials by conditioning on values of the variable specified in the substring `$VAR$`)| cell array of same size of opts.btsp_variables, each element contains the type of shuffling to be performed for the variable (either "all"` or `"Cconditioned"`, `"Rconditioned"`, or `"Sconditioned"`)                                                                    | N/A       |
%%% | opts.btsp_bias                       | bias correction method to be applied for each variable (same values than in opts.bias)              
